<!-- index.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <base href="./">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Автомобили — старт</title>

  <link rel="stylesheet" href="styles.css">
  <script src="common.js" defer></script>

  <script defer>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('start-form');
      const nameInput = document.getElementById('player-name');
      const levelSelect = document.getElementById('start-level');

      const lastPlayer = getCurrentPlayerName();
      if (lastPlayer) nameInput.value = lastPlayer;

      levelSelect.value = String(getStartLevel());

      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const name = nameInput.value.trim();
        if (!name) {
          await showAlert('Введите имя!', 'Ошибка');
          return;
        }

        const lvl = Number(levelSelect.value) || 1;

        setCurrentPlayerName(name);
        setStartLevel(lvl);
        resetCurrentGameState();
        goTo('game.html');
      });

      document.getElementById('btn-rating')
        .addEventListener('click', () => goTo('rating.html'));
    });
  </script>
</head>

<body class="screen screen-start">
  <div class="screen-container">
    <h1 class="title">Игровое приложение «Автомобили»</h1>
    <p class="subtitle">Мини-авторизация</p>

    <form id="start-form" class="card card-start">
      <label for="player-name">Введите ваше имя:</label>
      <input id="player-name" type="text" maxlength="20" required>

      <label for="start-level">Стартовый уровень (для тестирования):</label>
      <select id="start-level">
        <option value="1">Уровень 1</option>
        <option value="2">Уровень 2</option>
        <option value="3">Уровень 3</option>
      </select>

      <button type="submit" class="btn primary">Начать игру</button>

      <button id="btn-rating" type="button" class="btn secondary">
        Посмотреть рейтинг игроков
      </button>
    </form>

    <div class="hint">
      <p>После игры ваши результаты будут сохранены и попадут в общий рейтинг.</p>
    </div>
  </div>
</body>
</html>
